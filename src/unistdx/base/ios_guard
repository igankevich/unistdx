#ifndef UNISTDX_BASE_IOS_GUARD
#define UNISTDX_BASE_IOS_GUARD

#include <ios>

namespace sys {

	/**
	\defgroup guard Guards
	\brief Enforce object state with RAII.
	*/

	/**
	\brief I/O stream state guard.
	\date 2018-05-21
	\author Ivan Gankevich
	\ingroup base guard
	\details
	Saves/restores \link std::ios_base\endlink flags and fill character upon
	construction/destruction.
	*/
	class ios_guard {

	private:
		std::ios& _stream;
		std::ios_base::fmtflags _oldf;
		std::ios::char_type _oldfill;

	public:

		/// Construct the guard from stream \p s.
		inline explicit
		ios_guard(std::ios& s):
		_stream(s),
		_oldf(s.flags()),
		_oldfill(s.fill())
		{}

		inline
		~ios_guard() {
			this->_stream.setf(this->_oldf);
			this->_stream.fill(this->_oldfill);
		}

	};

}

#endif // vim:filetype=cpp
